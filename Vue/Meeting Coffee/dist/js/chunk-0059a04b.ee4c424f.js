(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0059a04b"],{3837:function(t,a,s){"use strict";s.r(a);var o=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"my"},[Object.keys(t.myData).length>0?s("div",[s("div",{staticClass:"my-box",style:{backgroundImage:"url("+t.myData.userBg+")"}},[s("van-uploader",{attrs:{"after-read":t.uploadBg}}),s("div",{staticClass:"navName"},[t._v("我的")]),s("div",{staticClass:"my-top"},[s("div",{staticClass:"top-content"},[s("div",{staticClass:"left-img"},[s("img",{staticClass:"auto-img",attrs:{src:t.myData.userImg,alt:""}})]),s("div",{staticClass:"right-name"},[s("div",{staticClass:"name"},[t._v(t._s(t.myData.nickName))])]),s("div",{staticClass:"desc"},[t._v("简介:"+t._s(""==t.myData.desc?"这家伙很懒，什么也没留下":t.myData.desc))])])])],1)]):s("div",{staticClass:"my-box"},[s("div",{staticClass:"btn"},[s("van-button",{attrs:{round:"",type:"info"},on:{click:t.goLogin}},[t._v("请登录")])],1)]),s("div",{staticClass:"mes-box"},[s("div",{staticClass:"mes-boxing"},t._l(t.mynavData,(function(t,a){return s("van-cell",{key:a,attrs:{title:t.title,size:"large","is-link":"",to:t.to,icon:t.icon}})})),1),s("div",{staticClass:"mes-boxing"},[s("div",{staticClass:"manager-box"},[s("van-cell",{attrs:{title:"修改密码","is-link":"",icon:"edit"},on:{click:t.showPopup}}),s("van-cell",{attrs:{title:"注销账号","is-link":"",icon:"warning-o"},on:{click:t.cancellation}})],1),s("van-popup",{style:{height:"40%"},attrs:{closeable:"",round:"",position:"bottom"},model:{value:t.show,callback:function(a){t.show=a},expression:"show"}},[s("div",{staticClass:"regist-content"},[s("div",{staticClass:"regist-title"},[s("h2",[t._v("修改密码")])]),s("div",{staticClass:"regist-mes"},[s("van-form",[t._l(t.passwords,(function(a,o){return s("van-field",{key:o,attrs:{type:a.isPassword?"password":"text",label:a.title,placeholder:"请输入6-16位且为字母开头的密码","right-icon":a.isPassword?"closed-eye":"eye-o"},on:{"click-right-icon":function(s){return t.showPassword(a)}},model:{value:a.password,callback:function(s){t.$set(a,"password",s)},expression:"item.password"}})})),s("div",{staticClass:"regist-btn2"},[s("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit"},on:{click:t.modifyPassword}},[t._v("确认修改")])],1)],2)],1)])])],1),s("div",{staticClass:"signout-box"},[s("van-button",{attrs:{block:"",round:""},on:{click:t.signOut}},[t._v("退出登录")])],1)])])},e=[],i=(s("c975"),s("a15b"),s("ac1f"),s("5319"),s("1276"),s("aa7c"),s("2f14")),n=s("e3a8"),r={data:function(){return{myData:[],mynavData:[{title:"个人资料",icon:"user-circle-o",to:{name:"PersonalData"}},{title:"我的收藏",icon:"like-o",to:{name:"Collection"}},{title:"地址管理",icon:"location-o",to:{name:"AddressManagement"}}],passwords:{old:{password:"",title:"旧密码",isPassword:!0},new:{password:"",title:"新密码",isPassword:!0}},active:0,show:!1,maxSize:512e3}},created:function(){this.getMy()},methods:{goLogin:function(){this.$router.push({name:"Login"})},getMy:function(){var t=this;this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0,loadingType:"spinner"}),this.axios({method:"GET",url:"/findMy",params:{appkey:this.appkey,tokenString:localStorage.getItem("WTPTK")}}).then((function(a){t.$toast.clear(),"A001"==a.data.code&&(t.myData=a.data.result[0])})).catch((function(a){t.$toast.clear()}))},uploadBg:function(t){var a=this,s=localStorage.getItem("WTPTK");s||(this.$notify({message:"请先登录",color:"#fff",background:"#0c34ba",duration:800}),this.$router.push({name:"Login"}));var o=t.file.type.split("/")[1],e=["jpg","png","gif","jpeg"];if(-1!=e.indexOf(o))if(this.maxSize<t.file.size)this.$toast("上传图片大小不能超过"+this.maxSize+"KB");else{var n=t.content.replace(/data:image\/[A-Za-z]+;base64,/,""),r={appkey:this.appkey,tokenString:s,imgType:o,serverBase64Img:n};r=i["a"].queryString(r),this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0,loadingType:"spinner"}),this.axios({method:"POST",url:"/updateUserBg",data:r}).then((function(t){a.$toast.clear(),"I001"==t.data.code&&(a.myData.userBg=t.data.userBg),a.$toast(t.data.msg)})).catch((function(t){a.$toast.clear()}))}else this.$toast("仅支持"+e.join(","))},back:function(){this.$router.go(-1)},showPopup:function(){var t=localStorage.getItem("WTPTK");t||(this.$notify({message:"请先登录",color:"#fff",background:"#3585f9",duration:800}),this.$router.push({name:"Login"})),this.show=!0},showPassword:function(t){t.isPassword=!t.isPassword},modifyPassword:function(){var t=this,a=localStorage.getItem("WTPTK");a||(this.$notify({message:"请先登录",color:"#fff",background:"#3585f9",duration:800}),this.$router.push({name:"Login"}));var s={oldPassword:{value:this.passwords.old.password,reg:/^[A-Za-z]\w{5,15}$/,errorMsg:"旧密码错误"},password:{value:this.passwords.new.password,reg:/^[A-Za-z]\w{5,15}$/,errorMsg:"新密码格式错误"}};if(n["a"].valid(s)){this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0,loadingType:"spinner"});var o={appkey:this.appkey,tokenString:a,password:this.passwords.new.password,oldPassword:this.passwords.old.password};o=i["a"].queryString(o),this.axios({method:"POST",url:"/updatePassword",data:o}).then((function(a){t.$toast.clear(),"E001"==a.data.code&&(t.$toast(a.data.msg),localStorage.removeItem("WTPTK"),t.$router.push({name:"Login"}))})).catch((function(a){t.$toast.clear()}))}},signOut:function(){var t=this,a=localStorage.getItem("WTPTK");if(!a)return this.$notify({message:"请先登录",color:"#fff",background:"#3585f9",duration:800}),void this.$router.push({name:"Login"});this.$dialog.confirm({title:"退出登录",message:"是否退出登录?",confirmButtonColor:"#3585f9"}).then((function(){t.$toast.loading({message:"加载中...",forbidClick:!0,duration:0,loadingType:"spinner"}),localStorage.removeItem("WTPTK"),setTimeout((function(){t.$toast.clear(),t.$router.push({name:"Login"})}),800)})).catch((function(){}))},cancellation:function(){var t=this,a=localStorage.getItem("WTPTK");if(!a)return this.$notify({message:"请先登录",color:"#fff",background:"#3585f9",duration:800}),void this.$router.push({name:"Login"});this.$dialog.confirm({title:"注销账号",message:"是否注销账号?",confirmButtonColor:"#3585f9"}).then((function(){t.$toast.loading({message:"加载中...",forbidClick:!0,duration:0,loadingType:"spinner"});var s=i["a"].queryString({appkey:t.appkey,tokenString:a});t.axios({method:"POST",url:"/destroyAccount",data:s}).then((function(a){t.$toast.clear(),t.$toast(a.data.msg),"G001"==a.data.code&&(localStorage.removeItem("WTPTK"),setTimeout((function(){t.$router.push({name:"Login"})}),800))})).catch((function(a){t.$toast.clear()}))})).catch((function(){}))}}},c=r,l=s("2877"),d=Object(l["a"])(c,o,e,!1,null,"b0fde034",null);a["default"]=d.exports},aa7c:function(t,a,s){},e3a8:function(t,a,s){"use strict";s.d(a,"a",(function(){return c}));var o=s("d4ec"),e=s("bee2"),i=(s("9a83"),s("f564")),n=s("2b0e");n["a"].use(i["a"]);var r=function(){function t(){Object(o["a"])(this,t)}return Object(e["a"])(t,[{key:"valid",value:function(t){for(var a in t)if(!t[a].reg.test(t[a].value))return Object(i["a"])({message:t[a].errorMsg,color:"#fff",background:"#3585f9"}),!1;return!0}}]),t}(),c=new r}}]);
//# sourceMappingURL=chunk-0059a04b.ee4c424f.js.map